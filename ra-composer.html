<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RA Application — Single Text Composer</title>
  <style>
	:root{
	  --bg:#0f1115; --panel:#151821; --ink:#e7eaf3; --muted:#9aa3b2;
	  --ok:#5fd38b; --warn:#ff9f1a; --bad:#ff4d4f; --border:#2a2f3a; --focus:#7dd3fc;
	}
	html,body{height:100%}
	body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
	header{position:sticky;top:0;z-index:5;background:linear-gradient(180deg,rgba(21,24,33,.98),rgba(21,24,33,.92));border-bottom:1px solid var(--border);backdrop-filter:blur(8px)}
	.wrap{max-width:900px;margin:0 auto;padding:16px}
	.title{display:flex;align-items:center;justify-content:space-between;gap:14px}
	.title h1{font-size:20px;margin:0}
	.counter{font-variant-numeric:tabular-nums;font-weight:800;font-size:22px;padding:6px 10px;border-radius:12px;border:1px solid var(--border);min-width:7ch;text-align:right}
	.counter.ok{color:var(--ok)}
	.counter.warn{color:var(--warn)}
	.counter.bad{color:var(--bad)}
	.toolbar{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
	.toolbar button,.toolbar label{background:#1b2030;color:var(--ink);border:1px solid var(--border);padding:8px 12px;border-radius:12px;cursor:pointer;font-weight:600;font-size:14px}
	.toolbar button:hover{background:#232938}
	main{padding:18px 0 80px}
	.card{background:var(--panel);border:1px solid var(--border);border-radius:16px;box-shadow:0 10px 20px rgba(0,0,0,.3)}
	.card header{padding:12px 14px;border-bottom:1px dashed var(--border);display:flex;align-items:center;justify-content:space-between}
	textarea{display:block;width:100%;min-height:48vh;max-height:70vh;resize:vertical;padding:16px;background:#0e1119;color:var(--ink);border:none;outline:none;border-radius:0 0 16px 16px;font-size:16px;line-height:1.5}
	textarea.orange{box-shadow:inset 0 0 0 2px var(--warn)}
	textarea.red{box-shadow:inset 0 0 0 2px var(--bad)}
	.actions{display:flex;gap:8px;align-items:center;flex-wrap:wrap;padding:10px 14px}
	.small{font-size:12px;color:var(--muted)}
	footer{position:fixed;bottom:10px;left:10px;right:10px}
	.hint{max-width:900px;margin:0 auto;background:#0b0e14;color:var(--muted);border:1px dashed var(--border);border-radius:12px;padding:8px 12px;font-size:13px}
	@media print{header,.toolbar,footer,.hint{display:none!important} body{background:#fff;color:#000} .card{box-shadow:none;border:1px solid #000} textarea{border:none;box-shadow:none}}
  </style>
</head>
<body>
  <header>
	<div class="wrap">
	  <div class="title">
		<h1>RA — Single Text Composer</h1>
		<div id="counter" class="counter ok" aria-live="polite" aria-label="Character count">0</div>
	  </div>
	  <div class="toolbar" role="toolbar" aria-label="Controls">
		<button id="copyBtn" title="Copy text to clipboard">Copy</button>
		<button id="exportBtn" title="Download as .txt">Export</button>
		<button id="printBtn" title="Print">Print</button>
		<label><input type="checkbox" id="monoToggle"> Monospace</label>
		<span class="small">Orange at 820 · Red over 900</span>
	  </div>
	</div>
  </header>

  <main class="wrap">
	<section class="card">
	  <header>
		<strong>Text</strong>
		<div class="small">Max target 900 chars</div>
	  </header>
	  <div class="actions">
		<button id="clearBtn" class="small-btn">Clear</button>
		<span id="overMsg" class="small" aria-live="polite"></span>
	  </div>
	  <textarea id="text" spellcheck="true" aria-label="Application text"></textarea>
	</section>
  </main>

  <footer>
	<div class="hint" id="hint"><strong>Tip:</strong> Your text auto‑saves locally. Use Copy for forms; Export for a .txt file.</div>
  </footer>

<script>
(function(){
  const WARN_AT = 820;    // orange at ≥820
  const LIMIT   = 900;    // red when >900
  const KEY     = 'ra_single_text_v1';

  const ta = document.getElementById('text');
  const counter = document.getElementById('counter');
  const overMsg = document.getElementById('overMsg');
  const hint = document.getElementById('hint');

  // restore saved
  try{ ta.value = localStorage.getItem(KEY) || ''; }catch(_){ ta.value=''; }

  function apply(len){
	counter.textContent = String(len);
	counter.classList.remove('ok','warn','bad');
	ta.classList.remove('orange','red');
	overMsg.textContent = '';
	if(len > LIMIT){
	  counter.classList.add('bad');
	  ta.classList.add('red');
	  overMsg.textContent = `Over by ${len - LIMIT}`;
	} else if(len >= WARN_AT){
	  counter.classList.add('warn');
	  ta.classList.add('orange');
	} else {
	  counter.classList.add('ok');
	}
  }

  apply(ta.value.length);

  ta.addEventListener('input', () => {
	const len = ta.value.length;
	apply(len);
	try{ localStorage.setItem(KEY, ta.value); }catch(_){ }
  });

  // buttons
  document.getElementById('copyBtn').addEventListener('click', async () => {
	try{ await navigator.clipboard.writeText(ta.value); toast('Copied to clipboard'); }
	catch(_){ ta.select(); document.execCommand('copy'); toast('Copied (fallback)'); }
  });
  document.getElementById('exportBtn').addEventListener('click', () => {
	const blob = new Blob([ta.value], { type:'text/plain;charset=utf-8' });
	const url = URL.createObjectURL(blob);
	const a = document.createElement('a'); a.href=url; a.download='RA_text.txt'; a.click();
	URL.revokeObjectURL(url);
  });
  document.getElementById('printBtn').addEventListener('click', () => window.print());
  document.getElementById('clearBtn').addEventListener('click', () => {
	if(confirm('Clear text?')){ ta.value=''; apply(0); try{ localStorage.setItem(KEY,''); }catch(_){ } }
  });
  document.getElementById('monoToggle').addEventListener('change', (e) => {
	document.body.style.setProperty('font-family', e.target.checked ? 'ui-monospace, SFMono-Regular, Menlo, Consolas, monospace' : 'system-ui, -apple-system, Segoe UI, Roboto, sans-serif');
  });

  let t=null; function toast(msg){
	if(hint){ hint.innerHTML = `<strong>${msg}</strong>`; }
	clearTimeout(t); t=setTimeout(()=>{ if(hint){ hint.innerHTML = '<strong>Tip:</strong> Your text auto‑saves locally. Use Copy for forms; Export for a .txt file.'; } }, 1800);
  }
})();
</script>
</body>
</html>